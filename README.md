<!--
---
title: Token Entropy Estimator
category: genai
difficulty: 4
description: Estimate token strength via entropy, search space, and crack-time.
tags: [entropy, token, security, education]
demo: https://ipusiron.github.io/token-entropy-estimator/
---
-->

# Token Strength Checker - エントロピー測定によるトークン強度チェッカー

![GitHub Repo stars](https://img.shields.io/github/stars/ipusiron/token-strength-checker?style=social)
![GitHub forks](https://img.shields.io/github/forks/ipusiron/token-strength-checker?style=social)
![GitHub last commit](https://img.shields.io/github/last-commit/ipusiron/token-strength-checker)
![GitHub license](https://img.shields.io/github/license/ipusiron/token-strength-checker)
[![GitHub Pages](https://img.shields.io/badge/demo-GitHub%20Pages-blue?logo=github)](https://ipusiron.github.io/token-strength-checker/)

**Day048 - 生成AIで作るセキュリティツール100**

入力した **トークン/秘密鍵/ランダム文字列** の強度を、以下の観点から**即時に可視化**します。

- 推定アルファベットサイズ（文字集合） 
- 長さ  
- 推定エントロピー（bit）  
- 総探索空間と想定総当たり時間（任意の試行レート）  
- フォーマット特定（UUID v4/Hex/Base64風など）  

---

## 🌐 デモページ

👉 **[https://ipusiron.github.io/token-strength-checker/](https://ipusiron.github.io/token-strength-checker/)**

ブラウザーで直接お試しいただけます。

---

## 📸 スクリーンショット

> ![ダミー](assets/screenshot.png)  
>
> *ダミー*

---

## ✨ 機能
- 自動判定：小文字/大文字/数字/記号/空白/Hex-Only/Base64風/UUID v4 など
- エントロピー推定：`H ≈ n * log2(|Alphabet|)`（一様・独立を仮定）
- 総当たり時間：指定した**試行レート（推測/秒）**での中央値（空間/2）を算出
- しきい値判定：弱い/普通/強い（デフォルトしきい：64/80/100 bits）
- 参考情報：Shannonエントロピー（文字頻度ベース、参考値）
- サンプル入力ボタン（UUID v4, Hex32, Base64-ish, ランダム英数など）

> ※単一サンプルからの真のエントロピー厳密推定は不可能なため、本ツールは**一般的な仮定**と**フォーマット検知**を用いた**教育・設計支援**用の推定器です。

---

## 🚀 使い方
1. トークンを入力  
2. （必要なら）**試行レート**を設定（例：`1e9` = 10億 guesses/sec）  
3. **解析する** を押す  
4. エントロピーと総当たり所要時間を確認

---

## 🔧 推定アルゴリズムの要点
- **アルファベット検知**  
  - `a–z`, `A–Z`, `0–9`, 記号（ASCII記号集合）、空白を検出  
  - 特殊：  
    - **Hex-Only**（`0-9a-fA-F` のみ） → |Σ|=16  
    - **UUID v4**（`8-4-4-4-12` 形式、ver=4/variant=8,b,9,a,B の検証）  
    - **Base64風**（`[A-Za-z0-9+/]` と `=` を末尾パディングとして許容）
- **エントロピー推定**： `H = n * log2(|Σ|)`  
- **総当たり時間（中央値）**： `T ≈ (|Σ|^n)/2 / rate`  
- **Shannon参考値**：サンプル内の相対頻度から `H_emp = -Σ p_i log2 p_i` を長さ倍して参考表示

---

## ✅ 判定基準（デフォルト）
- 〜63.9 bits：**弱い**
- 64.0〜99.9 bits：**ふつう**
- 100.0 bits〜：**強い**

> 例：英数62文字集合で16桁 → `16 * log2(62) ≈ 95.3 bits`（実務では十分強いケースが多い）

---

仕様書（Detailed Spec）
0. ゴール／非ゴール

ゴール

任意のトークン（UUID/Hex/Base64/英数・記号混在等）の強度を推定し、意思決定に必要な指標（推定エントロピー、探索空間、総当たり中央値時間、判定）を即時可視化する。

教育用途（設計レビューや講義、記事の図版作成）で使える、説明しやすい結果表示。

非ゴール

真の乱数性の厳密推定（単一サンプルからは不可能）

オフライン辞書攻撃やヒューリスティックによる構造的弱点の特定（本ツールは一般化した近似推定器）

1. ユースケース

開発・レビュー時に、生成しているAPIトークンや招待コードの強度を定量化したい

講義で「英数16桁 vs 32桁」「Hex vs Base64」の比較を視覚的に示したい

ユーザー入力の鍵素材を設計時に検討する（長さや文字集合の妥当性）

2. 入出力仕様（機能要件）
2.1 入力パラメータ

トークン（文字列）：任意文字列（Unicode可。主にASCII想定）

試行レート（guesses/sec）：Number

既定：1e9（10億回/秒）

形式：1e9, 1000000000, 2.5e12 など数値表現

不正時は既定値にフォールバック

判定しきい値（bits）：弱,普通,強 の3値

既定：64,80,100

形式："64,80,100"（カンマ区切り）

2.2 出力（表示項目）

長さ n：入力文字数（※UUIDのハイフンも長さに含め表示）

検出アルファベット（ラベル）：

a-z, A-Z, 0-9, symbols, space の組合せ

特殊フォーマット時は UUIDv4 (hex+hyphen), Hex (0-9,a-f), Base64-ish (A-Za-z0-9+/) 等

推定 |Σ|（アルファベットサイズ）

Generic：使用クラスから合算（a-z=26, A-Z=26, 0-9=10, symbols=33, space=1）

Hex：16

Base64-ish：64（=はパディング扱いで計数しない方針）

UUIDv4：16（計算は別扱い、下記参照）

推定エントロピー H（bits）

Generic/Hex/Base64-ish：

H ≈ n * log2(|Σ|)（各文字が独立かつ一様に選ばれると仮定）

UUIDv4：

実装可視化値：約122 bits（説明：128bit中、version/variantで固定されるビットあり／教育用近似）

Shannon参考値（bits）

入力内の相対頻度 p_i から H_shannon_total = (-Σ p_i log2 p_i) * n

文字の偏りが大きければこの値は小さくなる（参考値であり、上記推定とは意味が異なる）

探索空間 |Σ|^n

非常に大きい場合は近似表記（例：先頭3桁+指数）

UUIDv4 は ≈ 2^122 と表記可

中央値所要時間（秒→可読化）

総当たりの中央値 ≈ (|Σ|^n)/2

時間 T ≈ ((|Σ|^n)/2) / rate を年・日などへ可読化

試行レート（echo）

強度判定（弱い／ふつう／強い）

既定しきい値：弱 <64、普通 64-<100、強 ≥100

ラベル＋色バッジ表示

特記事項

UUIDv4、Base64-ish などフォーマットの補足

Base64は=パディング不計数等の注記

3. 検出ロジック（詳細）
3.1 フォーマット検知（優先）

UUID v4

正規表現：^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-4[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$

表示：UUIDv4 (hex+hyphen)、|Σ|=16 と表示しつつ、エントロピーは ~122 bits と固定近似

教育向け注記：version と variant により固定ビットが存在

Hex-only

正規表現：^[0-9a-fA-F]+$

|Σ|=16

Base64-ish

正規表現：^(?:[A-Za-z0-9+/]{2,}={0,2})$

|Σ|=64（=は計算から除外。ラベルに注記）

上記に当てはまらない場合は Generic として 3.2 に進む。

3.2 Generic アルファベット合成

検出クラス

小文字 [a-z] → +26

大文字 [A-Z] → +26

数字 [0-9] → +10

記号（ASCIIの印字可能記号33種）→ +33

ここでは教育上「使用可能性」を仮定して一括33とする

スペース → +1

どれも該当なし or 入力長0 → 評価不能（エラー表示）

4. 計算仕様
4.1 推定エントロピー（主表示）

H_est = n * log2(|Σ|)

4.2 参考：Shannonエントロピー

文字頻度 p_i による

H_shannon_per_char = -Σ p_i log2 p_i

H_shannon_total = H_shannon_per_char * n

偏りの可視化指標（乱数ではない固定文字列に対しては低く出やすい）

4.3 探索空間と時間

space = |Σ|^n（表示は大数近似）

中央値所要時間：T ≈ space/2 / rate

単位の可読化：ns/µs/ms/sec/min/hour/day/year

5. UI/UX 仕様（ワイヤー）
5.1 入力セクション

テキストエリア（トークン）

試行レート（テキスト入力）

判定しきい値（弱,普通,強 のビット値カンマ入力）

ボタン：解析する／クリア

サンプル挿入（折りたたみ）

UUID v4 / Hex(32) / Base64-ish / 英数16 / 英数32

5.2 結果セクション

2カラム（左：長さ・アルファベット・|Σ|・推定H・Shannon参考、右：探索空間・時間・レート・判定・特記事項）

強度ゲージ（プログレスバー）

0〜100%：max = 強しきい値 + 40bits を100%に正規化

色：弱＝赤系、普通＝黄系、強＝緑系

5.3 ルール概要セクション

数式と前提、特殊フォーマットの扱いを簡潔に記載

5.4 アクセシビリティ

主要数値はテキストでも表示（色み依存にしない）

aria-label を重要ボタンに設定

キーボード操作可能（Tab移動、Enterで解析）

6. バリデーション／エラー処理

入力空 → 「入力が空です」

rate が不正 or ≤0 → 既定 1e9 に置換し注記不要（静かにフォールバック）

しきい値文字列が不正 → 既定 64,80,100 に置換

|Σ|=0 or n=0 → 「評価不能」

7. 判定ロジック

比較対象：推定 H_est（UUIDは122固定近似）

既定しきい値（編集可）

H < 64 → 弱い

64 ≤ H < 100 → ふつう

100 ≤ H → 強い

8. 例（期待値）

| 入力例 | 解釈 | |Σ| | n | 推定H（bits） | 判定（既定） |
|---|---|---:|---:|---:|---|
| A7kLw39mQp8Zr2Tx（英数16桁） | Generic（英数） | 62 | 16 | ≈ 95.3 | ふつう |
| 英数32桁 | Generic（英数） | 62 | 32 | ≈ 190.6 | 強い |
| Hex32（[0-9a-f] 32桁） | Hex | 16 | 32 | 128.0 | 強い |
| UUID v4 | UUID | — | — | ~122（近似固定） | 強い |
| Base64-ish（24桁） | Base64 | 64 | 24 | 144.0 | 強い |
| aaaaaaaaaaaaaaaa | Generic（英小のみだが偏り大） | 26 | 16 | 75.2 | ふつう（Shannon参考は極小） |

備考：Shannon参考値は、aaaaaaaa… のような偏りで極端に小さくなることを確認できる。

9. 非機能要件

性能：入力長 4,000 文字程度で即時表示（O(n)）。大数計算は近似表示や BigInt を適宜使用

可搬性：Vanilla JS（依存なし）、静的ホスティング（GitHub Pages）可

セキュリティ：入力値は送信しない（クライアント側のみ）。ベンチマークや連続計算によるブラウザ過負荷を避けるため、即時計算のみ

10. テスト観点（受け入れ基準）

フォーマット検知

UUIDv4：正例／負例（version≠4、variant不正、桁不正、ハイフン欠如）

Hex-only：[0-9a-fA-F]+ のみ → Hex と判定

Base64-ish：= の位置、+/ の有無、英数字のみケース

|Σ| 合算

abcXYZ09 → 26+26+10=62

!@#（先頭スペース含む記号）→ 1（space）+33（symbols）=34

推定H

英数16/32 の既知値との照合（±0.01bits 許容）

Shannon参考値

aaaaaaaa… で極小になること

ランダム英数32で推定Hに近い値になる傾向

時間表示

レート変更（1e6, 1e9, 1e12）で単調に短くなること

UI

空入力で適切なメッセージ

しきい値・レートの不正値で既定フォールバック

強度ゲージの色・幅が判定に一致

11. 文言／注記（プロダクト内表示）

「この推定は一様・独立を仮定した近似です。人為的パターンや構造的制約は反映しません」

「Base64の = はパディングであり、アルファベットサイズに含めていません」

「UUID v4 は version / variant 固定ビットを考慮し、約122 bits として可視化しています」

12. 将来拡張（Roadmap、実装対象外）

構造解析：語彙・辞書・テンプレ修飾を検出するヒューリスティック

マルチサンプル統計：同一生成器から複数サンプルを投入して推定精度を上げる

端末実測ベンチ：ブラウザ上でハッシュ/比較ベンチを走らせて実測 rate をプリセット
※負荷・電力面の配慮が必要

---

## 📁 ディレクトリー構造

```
```

---

## 📘 理論解説
本ツールの背景にある **エントロピー計算や情報理論** については、  
[theory.md](theory.md) をご覧ください。

---

## 📄 ライセンス

MIT License - 詳細は [LICENSE](LICENSE) をご覧ください。

---

## 🛠 このツールについて

本ツールは、「生成AIで作るセキュリティツール100」プロジェクトの一環として開発されました。  
このプロジェクトでは、AIの支援を活用しながら、セキュリティに関連するさまざまなツールを  
100日間にわたり制作・公開していく取り組みを行っています。

プロジェクトの詳細や他のツールについては、以下のページをご覧ください。

🔗 [https://akademeia.info/?page_id=42163](https://akademeia.info/?page_id=42163)
